<html>

<head>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-83328246-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <style type="text/css">
    g.pointtext {
      display: none;
    }
  </style>

  <script>
    let perf = {}, data, header;

    function init() {
      $.get('performance.csv', function(perfData) {
        perfData = perfData.split('\n');
        if (perfData[perfData.length - 1] == '')
            perfData.pop()
        for (var i = 1; i < perfData.length; ++i) {
          var line = perfData[i].split(',');
          perf[line[0]] = Number(line[1]);
        }
        $.get('accuracy.csv', function(accData) {
          data = accData.split('\n');
          if (data[data.length - 1] == '')
              data.pop()
          header = data[0].split(',');

          var classes = document.getElementById("classes");
          for (var i = 1; i < header.length; ++i) {
            classes.innerHTML += '<option value="' + header[i] + '">' + header[i] + '</option>'
          }
          main();
        });
      });
    }

    function main() {
      Plotly.purge('tester');

      let classesSelect = document.getElementById("classes");
      let className = classesSelect.options[classesSelect.selectedIndex].value;
      let classId = header.indexOf(className);
      let xs = [];
      let ys = [];

      let layout = {
        title: {
          text: 'Deep learning tradeoff: accuracy against efficiency (object detection)',
        },
        xaxis: {
          title: {
            text: 'Average Precision @ IoU=0.50:0.95 (class "' + className + '") on COCO 2017 validation dataset'
          }
        },
        yaxis: {
          title: {
            text: 'Efficiency (FPS)',
          },
          showticklabels: false
        },
      }
      for (var i = 1; i < data.length; ++i) {
        let entry = data[i].split(',');
        let name = entry[0];
        let pltData = [{
          x: [Number(entry[classId])],
          y: [perf[name]],
          type: 'scatter',
          mode: 'markers+text',
          marker: {
            size: 20,
            line: {
              color: 'rgb(0, 0, 0)',
              width: 1
            },
          },
          name: name,
          text: name,
          textposition: 'right',
          hovertext: name,
          hoverinfo: 'x+text',
        }];

        Plotly.plot('tester', pltData, layout);
      }
    }
  </script>
</head>

<body onload="init()">
  Class to show: <select id="classes" onchange="main()"></select>

  <div id="tester" style="width: 100%;height: 100%"></div>
</body>

</html>
